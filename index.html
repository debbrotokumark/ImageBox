<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ImageBox Folder Gallery</title>
<style>
    * { box-sizing: border-box; }
body { margin:0; font-family: system-ui, Arial, sans-serif; background:#f6f7fb; color:#111; }
.wrap { max-width: 1100px; margin: 0 auto; padding: 18px; }

.top { background: #ffffff; border-bottom: 1px solid #e7e9f3; }
h1 { margin: 0; padding-top: 14px; }
.sub { margin: 8px 0 0; color:#444; }
.hint { margin: 10px 0 0; color:#666; font-size: 14px; }
code { background:#eef1ff; padding:2px 6px; border-radius: 6px; }

.controls { display:flex; gap: 10px; margin-top: 14px; }
.controls input {
  flex:1; padding: 12px 12px; border-radius: 12px;
  border: 1px solid #cfd5ea; outline: none; background:#fff;
}
.controls button {
  padding: 12px 14px; border-radius: 12px; border: 0;
  background:#2b59ff; color:#fff; font-weight: 700; cursor: pointer;
}
.controls button:disabled { opacity: .6; cursor: not-allowed; }

.status { margin: 14px 0; color:#333; }

.grid {
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 14px;
  padding-bottom: 28px;
}

.card {
  background:#fff;
  border: 1px solid #e7e9f3;
  border-radius: 16px;
  box-shadow: 0 10px 20px rgba(0,0,0,.06);
  overflow:hidden;
}

.card-head {
  padding: 12px 12px 10px;
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  border-bottom: 1px solid #eef0f7;
}

.title a { color:#2b59ff; text-decoration:none; font-weight: 800; }
.title a:hover { text-decoration: underline; }

.badge {
  font-size: 12px;
  background:#eef1ff;
  border:1px solid #dde3ff;
  color:#2b59ff;
  padding: 2px 10px;
  border-radius: 999px;
}

.imgs {
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 6px;
  padding: 10px;
}

.imgs a { display:block; border-radius: 12px; overflow:hidden; border: 1px solid #eef0f7; }
.imgs img { width:100%; height: 120px; object-fit: cover; display:block; }

.small-links {
  padding: 0 12px 12px;
  display:flex;
  gap: 10px;
  flex-wrap: wrap;
  color:#444;
  font-size: 14px;
}
.small-links a { color:#2b59ff; text-decoration:none; }
.small-links a:hover { text-decoration: underlin

</style>

</head>

<body>
  <header class="top">
    <div class="wrap">
      <h1>üìÅ ImageBox Folder Gallery</h1>
      <p class="sub">
        Auto loaded folders with 3 sample images each.
      </p>
    </div>
  </header>

  <main class="wrap">
    <div id="status" class="status"></div>
    <div id="grid" class="grid"></div>
  </main>

  <script src="./app.js"></script>
</body>
<script>
    
    // ====== FIXED CONFIG ======
const OWNER = "debbrotokumark";
const REPO = "ImageBox";
const BRANCHES = ["main", "master"];
const IMAGE_BASE = "https://debbrotokumark.github.io/ImageBox";
const SAMPLE_NUMBERS = [1, 2, 3];
// ==========================

const statusEl = document.getElementById("status");
const gridEl = document.getElementById("grid");

init();

function init() {
  loadFolders();
}

function setStatus(msg) {
  statusEl.textContent = msg || "";
}

async function loadFolders() {
  setStatus("Loading folders...");
  gridEl.innerHTML = "";

  try {
    const { branch, folders } = await fetchFolders();

    setStatus(`Found ${folders.length} folders.`);

    folders.forEach(folder => {
      renderFolder(folder.name, branch);
    });

  } catch (err) {
    setStatus("Error loading folders.");
  }
}

async function fetchFolders() {
  let lastError = null;

  for (const branch of BRANCHES) {
    try {
      const res = await fetch(
        `https://api.github.com/repos/${OWNER}/${REPO}/contents?ref=${branch}`
      );

      if (!res.ok) throw new Error("Branch failed");

      const data = await res.json();

      const folders = data
        .filter(item => item.type === "dir")
        .sort((a,b) => a.name.localeCompare(b.name));

      return { branch, folders };

    } catch (err) {
      lastError = err;
    }
  }

  throw lastError;
}

function renderFolder(folderName, branch) {

  const card = document.createElement("div");
  card.className = "card";

  const head = document.createElement("div");
  head.className = "card-head";

  head.innerHTML = `
    <div class="title">
      <a href="https://github.com/${OWNER}/${REPO}/tree/${branch}/${folderName}" target="_blank">
        ${folderName}
      </a>
    </div>
    <span class="badge">folder</span>
  `;

  const imgs = document.createElement("div");
  imgs.className = "imgs";

  SAMPLE_NUMBERS.forEach(n => {

    const imgUrl = `${IMAGE_BASE}/${folderName}/${folderName}-${n}.jpg`;

    const a = document.createElement("a");
    a.href = imgUrl;
    a.target = "_blank";

    const img = document.createElement("img");
    img.src = imgUrl;
    img.alt = `${folderName}-${n}.jpg`;

    img.onerror = () => {
      img.style.display = "none";
    };

    a.appendChild(img);
    imgs.appendChild(a);
  });

  const links = document.createElement("div");
  links.className = "small-links";

  links.innerHTML = `
    <a href="https://github.com/${OWNER}/${REPO}/tree/${branch}/${folderName}" target="_blank">
      Open Folder
    </a>
  `;

  card.appendChild(head);
  card.appendChild(imgs);
  card.appendChild(links);

  gridEl.appendChild(card);
}

</script>
</html>
